\begin{vAlgorithm}[!ht]{1\columnwidth}{0em}
\LinesNumbered
\DontPrintSemicolon

\SetKwInOut{Require}{Require}

\caption{Create Hessian.}\label{alg:ch5:hessian}

\Require{ structures $\mathcal{L}$ and $\mathcal{M}$ of type \xvar{objective}}

 [$\xvar{IL}, \xvar{JL}, \xvar{VL}$] $\gets$ Algorithm~\ref{alg:ch5:Lterms} using $\mathcal{L}$  \tcc*{Lagrange term sequences}

[$\xvar{IM}, \xvar{JM}, \xvar{VM}$] $\gets$ Algorithm~\ref{alg:ch5:Mterms} using $\mathcal{M}$ \tcc*{Mayer term sequences}

$\xvar{I}$ $\gets$ \textsc{combine}(\xvar{IL}, \xvar{IM})

$\xvar{J}$ $\gets$ \textsc{combine}(\xvar{JL}, \xvar{JM})

$\xvar{V}$ $\gets$ \textsc{combine}(\xvar{VL}, \xvar{VM})

$\xvar{H}$ $\gets$ \textsc{sparse}(\xvar{I}, \xvar{J}, \xvar{V}, $n_X$, $n_X$) \tcc*{sparse matrix with $n_X$ by $n_X$ size}

$\mathbf{H}$ $\gets$ $\xvar{H} + \xvar{H}\tran$ \tcc*{make symmetric for $\mathbf{X}\tran \mathbf{H} \mathbf{X}/2$ form}

\textbf{return} $\mathbf{H}$ \tcc*{Hessian}

\end{vAlgorithm}